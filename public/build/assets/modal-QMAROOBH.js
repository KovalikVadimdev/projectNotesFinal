import{a as y,h as f}from"./profileName-BissPeNV.js";class v{constructor(s){this.modal=s,this.blocks=s.querySelectorAll(".js-signin-modal-block"),this.switchers=s.querySelectorAll(".js-signin-modal-switcher a"),this.triggers=document.querySelectorAll(".js-signin-modal-trigger"),this.hidePasswordBtns=s.querySelectorAll(".js-hide-password"),this.init()}init(){this.triggers.forEach(s=>{s.addEventListener("click",e=>{const t=e.target.closest("[data-signin]");if(t){e.preventDefault();const a=t.getAttribute("data-signin");this.showForm(a)}})}),this.modal.addEventListener("click",s=>{(s.target.classList.contains("js-signin-modal")||s.target.classList.contains("js-close"))&&(s.preventDefault(),this.modal.classList.remove("signin-modal--is-visible"))}),this.hidePasswordBtns.forEach(s=>{s.addEventListener("click",()=>this.togglePassword(s))})}togglePassword(s){const e=s.previousElementSibling,t=e.type==="password";e.type=t?"text":"password",s.textContent=t?"Hide":"Show",this.putCursorAtEnd(e)}showForm(s){this.modal.classList.add("signin-modal--is-visible"),this.blocks.forEach(t=>{t.classList.toggle("signin-modal__block--is-selected",t.getAttribute("data-type")===s)});const e=s==="signup"?"signup":"login";this.switchers.forEach(t=>{t.classList.toggle("selected",t.getAttribute("data-type")===e)})}putCursorAtEnd(s){s.focus();const e=s.value.length;s.setSelectionRange(e,e)}}const g=document.querySelector(".js-signin-modal");g&&new v(g);const o=document.querySelector(".js-main-nav");o&&o.addEventListener("click",n=>{n.target.classList.contains("js-main-nav")&&o.querySelector("ul").classList.toggle("main-nav__list--is-visible")});const p=document.getElementById("signin");p.addEventListener("click",async n=>{var t,a,r;n.preventDefault();const s=(t=document.querySelector("#signin-email"))==null?void 0:t.value.trim(),e=(a=document.querySelector("#signin-password"))==null?void 0:a.value;try{const i=await y(s,e);if(i&&i.id_user){const{id_user:d,email:m,password:u,nickname:l,fullname:c,gender:h,country:S}=i;localStorage.setItem("id_user",JSON.stringify(d)),localStorage.setItem("email",JSON.stringify(m)),localStorage.setItem("password",JSON.stringify(u)),localStorage.setItem("nickname",JSON.stringify(l)),localStorage.setItem("fullname",JSON.stringify(c)),localStorage.setItem("gender",JSON.stringify(h)),localStorage.setItem("country",JSON.stringify(S)),(r=document.querySelector(".js-signin-modal"))==null||r.classList.remove("signin-modal--is-visible"),f({username:l,fullName:c},!0)}else alert("Неправильні облікові дані")}catch(i){console.error("Помилка під час авторизації:",i),alert("Сталася помилка під час авторизації")}});
